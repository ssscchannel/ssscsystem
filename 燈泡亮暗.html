<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™Ÿè‡ªç„¶è¼”åŠ©ç³»çµ±ã€€é›»è·¯å¯¦é©—å®¤</title>
    <style>
        /* --- æ ¸å¿ƒè®Šæ•¸ (ä¿ç•™åŸé›»è·¯æ¨¡æ“¬è¨­å®š) --- */
        :root {
            --wire-color: #333;
            --bg-color: #f0f4f8; /* åŒæ­¥ index èƒŒæ™¯è‰²èª¿ */
            --panel-color: #ffffff;
            --bulb-off: #bdc3c7;
            --bulb-dim-color: #d35400;   /* æœ€æš— */
            --bulb-norm-color: #f1c40f;  /* æ™®é€š */
            --bulb-bright-color: #fff700;/* æœ€äº® */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-image: url('page.jpg'); 
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-color: #f0f2f5;
            
            display: flex; flex-direction: column; align-items: center;
            /* ä¿®æ”¹ï¼šæ¸›å°‘ä¸Šä¸‹é‚Šè·ï¼Œç›¡é‡è®“å…§å®¹å¡é€²ä¸€é  */
            margin: 0; padding: 5px; 
            height: 100vh;       /* èˆŠæ‰‹æ©Ÿç›¸å®¹ */
            height: 100dvh;      /* é—œéµï¼šæ‰£é™¤å·¥å…·åˆ—å¾Œçš„å¯¦éš›é«˜åº¦ */
            overflow: hidden;    /* ç¦æ­¢ç”¢ç”Ÿä»»ä½•æ²è»¸ */
            touch-action: manipulation;
        }

        /* --- æ¨™é¡Œå€ (æ‰‹æ©Ÿç‰ˆç·Šæ¹ŠåŒ–) --- */
        .header-container {
            flex-shrink: 0; /* ç¦æ­¢è¢«å£“ç¸® */
            width: 97%;     /* ç¨å¾®ç•™é‚Š */
			box-sizing: border-box; /* ç¢ºä¿ padding ä¸æœƒè®“å®ƒè®Šæ›´å¯¬ */
            max-width: 800px;
            
            /* è®“æ¨™é¡Œåœ¨å·¦ï¼ŒæŒ‰éˆ•åœ¨å³ */
            display: flex;
            justify-content: space-between; 
            align-items: center;
            
            /* è¦–è¦ºç¾åŒ– */
            padding: 8px 15px;
            margin-top: 5px;
			margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.9); /* 90% ä¸é€æ˜åº¦ */
            backdrop-filter: blur(5px);
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); /* ç«‹é«”é™°å½± */
            z-index: 1000;
        }
		
        .title-logo {
            height: 36px; /* é™åˆ¶é«˜åº¦ï¼Œé¿å…æ’é–‹ */
            width: auto;
            border-radius: 4px;
        }
        .header-container h1 {
            margin: 0;
            font-size: 1.1rem;
            color: #333;
            line-height: 1.3;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px; /* Logo èˆ‡æ–‡å­—é–“è· */
        }
		
		/* =========================================
           3. å³ä¸Šè§’æŒ‰éˆ•ç¾¤ (æ–°åŠŸèƒ½)
           ========================================= */
        .nav-buttons {
            display: flex;
            gap: 8px; /* æŒ‰éˆ•ä¹‹é–“çš„é–“è· */
        }
		
		/* ç²¾ç·»åŒ–çš„ LINE æŒ‰éˆ• (è† å›Šç‹€) */
        .header-btn {
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            background: #06c755; /* LINE çš„å®˜æ–¹ç¶ è‰² */
            color: white;
            font-size: 0.9rem;
            font-weight: bold;
            border-radius: 20px; /* åœ“è§’è† å›Š */
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: transform 0.1s, background 0.2s;
            white-space: nowrap; /* ç¦æ­¢æ–‡å­—æ›è¡Œ */
        }
		
		.header-btn:active {
            transform: scale(0.95);
        }

        .header-btn span {
            margin-right: 4px; /* åœ–ç¤ºèˆ‡æ–‡å­—è·é›¢ */
        }

        /* --- æ–°å¢ï¼šå¤–éƒ¨é€£çµæŒ‰éˆ• (ç§»æ¤è‡ª index.html) --- */
        .external-link-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px; 
            text-decoration: none;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: #fff;
            
            /* æ¨£å¼ä¿æŒä¸€è‡´ */
            padding: 6px 18px; 
            font-size: 0.9rem; 
            
            border-radius: 50px;
            font-weight: bold;
            /* å¾®èª¿ï¼šé‡å°æ­¤æª”æ¡ˆè¼ƒç·Šæ¹Šçš„ä½ˆå±€ï¼Œå°‡åŸ margin-bottom: 20px å¾®èª¿ç‚º 10px */
            margin-bottom: 10px;
            box-shadow: 0 3px 8px rgba(52, 152, 219, 0.4);
            transition: all 0.2s ease;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .external-link-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(52, 152, 219, 0.6);
            background: linear-gradient(135deg, #2980b9 0%, #2c3e50 100%);
        }
        .external-link-btn:active {
            transform: scale(0.98);
        }
		
		/* --- æ•™å­¸å¼•å°ä»»å‹™æ¢æ¨£å¼ --- */
		.instruction-bar {
		    /* å®šä½èˆ‡ä½ˆå±€ */
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 8px; /* åœ–ç¤ºèˆ‡æ–‡å­—é–“è· */
			
			/* å°ºå¯¸é™åˆ¶ï¼Œèˆ‡æ¨™é¡Œå€ä¿æŒè¦–è¦ºå”èª¿ */
			max-width: 90%;
			width: fit-content; /* å…§å®¹å¤šå¯¬å°±å¤šå¯¬ï¼Œä¸è¦è‡ªå‹•æ’æ»¿æ•´è¡Œ */
			margin: -5px auto 15px auto; /* è² é‚Šè·å°‡å…¶å‘ä¸Šæ‹‰è¿‘æ¨™é¡Œï¼Œä¸‹æ–¹ç•™å‡ºå‘¼å¸ç©ºé–“ */
			
			/* å¤–è§€è¨­è¨ˆ - è¼•é‡åŒ– */
			padding: 6px 20px;
			background-color: rgba(255, 255, 255, 0.85); /* æ¯”æ¨™é¡Œå€æ›´é€šé€ */
			border-radius: 20px; /* åœ“æ½¤çš„è† å›Šç‹€ */
			box-shadow: 0 2px 8px rgba(0,0,0,0.05); /* æ¥µè¼•å¾®çš„é™°å½± */
			backdrop-filter: blur(4px); /* æ¯›ç»ç’ƒæ•ˆæœï¼Œå¢åŠ è³ªæ„Ÿ */
			
			/* æ–‡å­—è¨­å®š */
			color: #555; /* æ·±ç°è‰²ï¼Œä¸æ¶é»‘è‰²æ¨™é¡Œçš„æˆ² */
			font-size: 0.9rem;
			font-weight: 500;
			line-height: 1.4;
			text-align: center;
			pointer-events: none; /* è®“æ»‘é¼ å¯ä»¥ç›´æ¥ç©¿é€ï¼Œä¸æœƒé˜»æ“‹æ“ä½œ */
		}
		
		.instruction-bar .icon {
    		font-size: 1rem; /* åœ–ç¤ºç¨å¾®å¤§ä¸€é» */
		}

        /* --- ä¸»å®¹å™¨ (ä¿æŒåŸæ¨£ï¼Œå¾®èª¿ Margin) --- */
        .simulation-container {
            position: relative;
            width: 500px; height: 450px;
            background: var(--panel-color); border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex; flex-direction: column;
            align-items: center; justify-content: flex-start;
            padding-top: 30px; 
            overflow: hidden; 
            transition: all 0.3s ease;
            z-index: 1;
            /* margin-bottom ç”±å¤–éƒ¨æ§åˆ¶ï¼Œä¸å¼·åˆ¶ */
        }

        /* --- ä»¥ä¸‹ç‚ºåŸé›»è·¯æ¨¡æ“¬æ¨£å¼ï¼Œæœªåšé‚è¼¯æ›´å‹• --- */
        .circuit-scene {
            position: relative; width: 100%; height: 100%; display: none;
        }
        .circuit-scene.active { display: block; }

        .info-panel {
            position: absolute;  
            bottom: 10px;        
            left: 50%;           
            transform: translateX(-50%); 
            background: #ecf0f1;
            width: 90%;
            padding: 8px 10px;
            border-radius: 10px;
            text-align: center;
            border-left: 5px solid #3498db;
            max-height: 95px;
            overflow-y: auto;
            min-height: 70px;
            display: flex; flex-direction: column; justify-content: center;
            z-index: 20;
        }
        .info-title { font-weight: bold; color: #2980b9; margin-bottom: 5px; display: block;}
        .info-text { font-size: 0.95rem; line-height: 1.4; color: #555; }

        .wire {
            position: absolute; background-image: linear-gradient(0deg, #2c3e50, #5d6d7e 40%, #85929e 60%, #2c3e50);
            border-radius: 4px; z-index: 1; box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .wire-h { height: 6px; } .wire-v { width: 6px; }

        .bulb-wrapper {
            position: absolute; display: flex; flex-direction: column; align-items: center;
            z-index: 10; transition: transform 0.1s;
        }
        .bulb-wrapper[onclick] { cursor: pointer; }
        .bulb-wrapper:active { transform: scale(0.95); }

        .bulb-glass {
            width: 40px; height: 40px; border-radius: 50%; background-color: var(--bulb-off);
            border: 2px solid #95a5a6; box-shadow: inset -2px -2px 5px rgba(0,0,0,0.2);
            position: relative; transition: all 0.3s ease;
        }
        .bulb-base {
            width: 20px; height: 15px; background: linear-gradient(90deg, #7f8c8d, #bdc3c7, #7f8c8d);
            border: 1px solid #555; margin-top: -2px; border-radius: 0 0 5px 5px;
            background-image: repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0,0,0,0.2) 3px, rgba(0,0,0,0.2) 4px);
        }
        
        .lit-dim .bulb-glass { background-color: var(--bulb-dim-color); border-color: #d35400; box-shadow: 0 0 5px var(--bulb-dim-color), inset -2px -2px 5px rgba(0,0,0,0.1); }
        .lit-normal .bulb-glass { background-color: var(--bulb-norm-color); border-color: #f39c12; box-shadow: 0 0 25px var(--bulb-norm-color), inset -2px -2px 5px rgba(0,0,0,0.1); }
        .lit-bright .bulb-glass { background-color: var(--bulb-bright-color); border-color: #fff; box-shadow: 0 0 50px var(--bulb-bright-color), 0 0 80px rgba(255, 255, 224, 0.9), inset 0 0 10px #fff; }

        .bulb-wrapper.is-broken .bulb-glass {
            background-color: #444 !important;
            box-shadow: none !important;
            border-color: #333 !important;
        }

        .battery-group {
            position: absolute; display: flex; align-items: center; z-index: 5;
            transition: transform 0.1s;
        }
        .battery-group[onclick] { cursor: pointer; }
        .battery-group:active { transform: scale(0.95); }
        
        .battery-body {
            width: 60px; height: 36px; background: linear-gradient(to bottom, #34495e 0%, #5d6d7e 50%, #2c3e50 100%);
            border: 2px solid #ecf0f1; border-radius: 4px; box-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            display: flex; justify-content: space-between; align-items: center; padding: 0 5px; position: relative;
            transition: all 0.3s;
        }
        .battery-cap {
            width: 8px; height: 18px; background: linear-gradient(to bottom, #bdc3c7, #ecf0f1, #bdc3c7);
            border: 1px solid #95a5a6; border-right: none; border-radius: 3px 0 0 3px;
            position: absolute; left: -8px; top: 50%; transform: translateY(-50%); transition: all 0.3s;
        }
        .bat-sign { font-weight: 900; font-size: 18px; line-height: 1; }
        .sign-plus { color: #ff5252; text-shadow: 0 0 4px rgba(255, 82, 82, 0.8); }
        .sign-minus { color: #448aff; text-shadow: 0 0 4px rgba(68, 138, 255, 0.8); }

        .battery-group.is-dead .battery-body {
            background: linear-gradient(to bottom, #7f8c8d, #95a5a6) !important;
            border-color: #7f8c8d !important;
        }
        .battery-group.is-dead .battery-cap { background: #95a5a6 !important; }
        .battery-group.is-dead .sign-plus, 
        .battery-group.is-dead .sign-minus { color: #bdc3c7 !important; text-shadow: none !important; }

        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 500px; margin-top: 10px; margin-bottom: 30px;}
        .btn { 
            padding: 12px; border: none; border-radius: 8px; font-size: 0.95rem; cursor: pointer; color: white; 
            transition: all 0.2s; background: #95a5a6; font-family: inherit; line-height: 1.4;
        }
        .btn:hover { filter: brightness(1.1); }
        .btn.active { background: #3498db; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transform: translateY(1px); }
        
		/* RWD: æ‰‹æ©Ÿç›´å¼æ™‚ï¼Œæ¨™é¡Œéé•·è‡ªå‹•æ›è¡Œ */
        .mobile-break { display: none; }
        
        @media (max-width: 600px) {
            .mobile-break { display: block; height: 0; }
            .header-container h1 { font-size: 1rem; }
            .header-btn { padding: 5px 10px; font-size: 0.85rem; }
            .header-btn span { display: none; } /* æ‰‹æ©Ÿç‰ˆå¤ªçª„æ™‚ï¼Œéš±è—æ‰‹æŒ‡åœ–ç¤º */
			.instruction-bar {
    			font-size: 0.8rem; /* æ‰‹æ©Ÿå­—é«”ç¸®å° */
				padding: 5px 15px;
				width: 90%; /* æ‰‹æ©Ÿä¸Šå¯¬åº¦ç¨å¾®æ”¾å¯¬ */
				margin-top: 5px; /* æ‰‹æ©Ÿç‰ˆä¸ä½¿ç”¨è² é‚Šè·ï¼Œé¿å…å¤ªæ“æ“  */
				margin-bottom: 10px;
				flex-direction: row; /* ä¿æŒæ°´å¹³æ’åˆ— */
				flex-wrap: nowrap; /* ç›¡é‡ä¸æ›è¡Œï¼Œè‹¥å­—å¤ªå¤šæœƒè‡ªå‹•ç¸®å° */
				}
        }

            .simulation-container { 
                min-width: 500px; width: 500px; height: 450px;
                transform: scale(0.65); transform-origin: top center; margin-bottom: -150px; 
            } 
            .controls { 
                width: 500px; transform: scale(0.65); transform-origin: top center; margin-top: 10px;
            }
        }
    </style>
</head>
<body>

	<div class="header-container">
        <h1>
            <img src="logo.jpg" alt="Logo" class="title-logo" onerror="this.style.display='none'">
            <div>
                æ™Ÿè‡ªç„¶è¼”åŠ©ç³»çµ±ã€€<span class="mobile-break"></span>æ¯”è¼ƒä¸²è¯èˆ‡ä¸¦è¯çš„å·®ç•°
            </div>
        </h1>

        <div class="nav-buttons">
            <a href="https://line.me/ti/g2/TTCqPpZP6lQqX1z_AUDPNm4977Dvylew3O7oBg" target="_blank" class="header-btn" title="åŠ å…¥å®˜æ–¹LINE">
                <span>ğŸ‘‰</span>åŠ  LINE æå•
            </a>
            
            </div>
    </div>

    <div class="instruction-bar">
	    <span class="icon">ğŸ’¡</span>
		<span>è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œæ¯”è¼ƒç‡ˆæ³¡äº®åº¦</span>
	</div>

    <div class="simulation-container">
        
        <div class="circuit-scene" id="scene-A">
            <div class="wire wire-h" style="width: 240px; top: 40px; left: 130px;"></div>
            <div class="bulb-wrapper" id="a-b1" style="top: 20px; left: 170px;"><div class="bulb-glass"></div><div class="bulb-base"></div></div>
            <div class="bulb-wrapper" id="a-b2" style="top: 20px; left: 290px;"><div class="bulb-glass"></div><div class="bulb-base"></div></div>
            <div class="wire wire-v" style="top: 40px; bottom: 140px; left: 130px;"></div>
            <div class="wire wire-v" style="top: 40px; bottom: 140px; right: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; bottom: 140px; left: 130px;"></div>
            <div class="battery-group" id="a-bat1" style="bottom: 125px; left: 175px;">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            <div class="battery-group" id="a-bat2" style="bottom: 125px; left: 265px;">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
        </div>

        <div class="circuit-scene" id="scene-B">
            <div class="wire wire-h" style="width: 240px; top: 40px; left: 130px;"></div>
            <div class="bulb-wrapper" id="b-b1" style="top: 20px; left: 170px;"><div class="bulb-glass"></div><div class="bulb-base"></div></div>
            <div class="bulb-wrapper" id="b-b2" style="top: 20px; left: 290px;"><div class="bulb-glass"></div><div class="bulb-base"></div></div>

            <div class="wire wire-v" style="top: 40px; bottom: 140px; left: 130px;"></div>
            <div class="wire wire-v" style="top: 40px; bottom: 140px; right: 130px;"></div>

            <div class="wire wire-h" style="width: 240px; bottom: 200px; left: 130px;"></div> 
            <div class="wire wire-h" style="width: 240px; bottom: 140px; left: 130px;"></div> 
            
            <div class="battery-group" id="b-bat1" style="bottom: 185px; left: 220px;" onclick="toggleState(this)">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            <div class="battery-group" id="b-bat2" style="bottom: 125px; left: 220px;" onclick="toggleState(this)">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
        </div>

        <div class="circuit-scene" id="scene-C">
            <div class="wire wire-h" style="width: 240px; top: 30px; left: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; top: 100px; left: 130px;"></div>
            
            <div class="bulb-wrapper" id="c-b1" style="top: 10px; left: 230px;" onclick="toggleState(this)"><div class="bulb-glass"></div><div class="bulb-base"></div></div>
            <div class="bulb-wrapper" id="c-b2" style="top: 80px; left: 230px;" onclick="toggleState(this)"><div class="bulb-glass"></div><div class="bulb-base"></div></div>
            
            <div class="wire wire-v" style="top: 30px; bottom: 140px; left: 130px;"></div>
            <div class="wire wire-v" style="top: 30px; bottom: 140px; right: 130px;"></div>

            <div class="wire wire-h" style="width: 240px; bottom: 140px; left: 130px;"></div>
            <div class="battery-group" id="c-bat1" style="bottom: 125px; left: 175px;">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            <div class="battery-group" id="c-bat2" style="bottom: 125px; left: 265px;">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
        </div>

        <div class="circuit-scene" id="scene-D">
            <div class="wire wire-h" style="width: 240px; top: 30px; left: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; top: 90px; left: 130px;"></div> 
            
            <div class="bulb-wrapper" id="d-b1" style="top: 10px; left: 230px;" onclick="toggleState(this)"><div class="bulb-glass"></div><div class="bulb-base"></div></div>
            <div class="bulb-wrapper" id="d-b2" style="top: 70px; left: 230px;" onclick="toggleState(this)"><div class="bulb-glass"></div><div class="bulb-base"></div></div>

            <div class="wire wire-v" style="top: 30px; bottom: 140px; left: 130px;"></div>
            <div class="wire wire-v" style="top: 30px; bottom: 140px; right: 130px;"></div>

            <div class="wire wire-h" style="width: 240px; bottom: 200px; left: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; bottom: 140px; left: 130px;"></div>
            
            <div class="battery-group" id="d-bat1" style="bottom: 185px; left: 220px;" onclick="toggleState(this)">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            <div class="battery-group" id="d-bat2" style="bottom: 125px; left: 220px;" onclick="toggleState(this)">
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
        </div>

        <div class="info-panel">
            <span class="info-title" id="infoTitle">è«‹é¸æ“‡é›»è·¯</span>
            <span class="info-text" id="infoText">è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•åˆ‡æ›ä¸åŒæ¥æ³•ï¼Œè§€å¯Ÿç‡ˆæ³¡äº®åº¦è®ŠåŒ–ã€‚</span>
        </div>

    </div>

    <div class="controls">
        <button class="btn active" onclick="switchScene('A', this)">ç‡ˆæ³¡ä¸²è¯ ï¼‹ é›»æ± ä¸²è¯</button>
        <button class="btn" onclick="switchScene('B', this)">ç‡ˆæ³¡ä¸²è¯ ï¼‹ é›»æ± ä¸¦è¯</button>
        <button class="btn" onclick="switchScene('C', this)">ç‡ˆæ³¡ä¸¦è¯ ï¼‹ é›»æ± ä¸²è¯</button>
        <button class="btn" onclick="switchScene('D', this)">ç‡ˆæ³¡ä¸¦è¯ ï¼‹ é›»æ± ä¸¦è¯</button>
    </div>

    <script>
        // ã€æ™Ÿè‡ªç„¶ç³»çµ±ï¼šè‡ªå‹•è¦–çª—é©é…æ¨¡çµ„ã€‘
		function autoFitSimulation() {
    		// 1. å–å¾—æ¨™æº–é‚è¼¯å¯¬åº¦
			const logicalWidth = 500; 
			const logicalHeight = 450;
			
			// 2. æŠ“å–ç•¶å‰è¢å¹•å¯¬åº¦ (é™åˆ¶æœ€å¤§ä¸è¶…é 500pxï¼Œä»¥å…é›»è…¦ç‰ˆéå¤§)
			const screenWidth = Math.min(window.innerWidth, 500);
			
			// 3. è¨ˆç®—ç²¾ç¢ºç¸®æ”¾æ¯”ä¾‹ (ä¾‹å¦‚: æ‰‹æ©Ÿå¯¬ 375 / é‚è¼¯å¯¬ 500 = 0.75)
			// æ‰£é™¤ 20px æ˜¯ç‚ºäº†å·¦å³ç•™ä¸€é»å‘¼å¸ç©ºé–“ï¼Œè‹¥æƒ³å…¨æ»¿å¯ç§»é™¤ "- 20"
			const scale = (screenWidth - 20) / logicalWidth; 
			
			// 4. å‹•æ…‹ä¿®æ­£ CSS
			const container = document.querySelector('.simulation-container');
			const controls = document.querySelector('.controls');
			
			// è¨ˆç®—ç¸®æ”¾å¾Œç”¢ç”Ÿçš„åº•éƒ¨ç©ºéš™ï¼Œè‡ªå‹•è£œæ­£ margin-bottom
			const ghostSpace = logicalHeight * (1 - scale);
			
			if (container) {
			container.style.transform = `scale(${scale})`;
			container.style.marginBottom = `-${ghostSpace}px`;
			}
			if (controls) {
			controls.style.transform = `scale(${scale})`;
			}
		}
		
		// åŸ·è¡Œé©é… (è¼‰å…¥æ™‚èˆ‡æ—‹è½‰è¢å¹•æ™‚)
		window.addEventListener('load', autoFitSimulation);
		window.addEventListener('resize', autoFitSimulation);
		
		window.onload = function() {
            switchScene('A', document.querySelector('.btn'));
        }

        function switchScene(mode, btn) {
            document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            
            document.querySelectorAll('.circuit-scene').forEach(s => s.classList.remove('active'));
            document.getElementById('scene-' + mode).classList.add('active');
            
            updatePhysics(mode);
        }

        // â˜…â˜…â˜… æ ¸å¿ƒé‚è¼¯ (å®Œå…¨ä¿ç•™) â˜…â˜…â˜…
        function toggleState(element) {
            const scene = element.closest('.circuit-scene');
            
            // 1. ç‡ˆæ³¡é‚è¼¯ï¼šç¦æ­¢å°‡å…©é¡†éƒ½é—œæ‰
            if (element.classList.contains('bulb-wrapper')) {
                // å¦‚æœæ˜¯ã€Œæº–å‚™é—œæ‰ã€(ç›®å‰æ²’å£)ï¼Œæ‰æª¢æŸ¥
                if (!element.classList.contains('is-broken')) {
                    const allBulbs = scene.querySelectorAll('.bulb-wrapper');
                    const brokenBulbs = scene.querySelectorAll('.bulb-wrapper.is-broken');
                    // å¦‚æœå£æ‰æ•¸é‡ + 1 ç­‰æ–¼ ç¸½æ•¸é‡ï¼Œè¡¨ç¤ºé€™æ¬¡é—œæ‰å¾Œå°±å…¨æ»…äº† -> ç¦æ­¢
                    if (brokenBulbs.length + 1 >= allBulbs.length) {
                        return; // ç›´æ¥çµæŸï¼Œä¸åŸ·è¡Œ toggle
                    }
                }
                element.classList.toggle('is-broken');
            } 
            
            // 2. é›»æ± é‚è¼¯ï¼šå¯ä»¥éš¨æ„é–‹é—œ
            else if (element.classList.contains('battery-group')) {
                element.classList.toggle('is-dead');
            }

            // 3. æ¯æ¬¡é»æ“Šå¾Œï¼Œé‡æ–°è¨ˆç®—é›»è·¯é€šæ–·ç‹€æ…‹
            recalcCircuitState(scene);
        }

        // é‡æ–°è¨ˆç®—ç•¶å‰å ´æ™¯çš„ç‰©ç†ç‹€æ…‹
        function recalcCircuitState(scene) {
            const sceneId = scene.id;
            const bulbs = scene.querySelectorAll('.bulb-wrapper');
            
            // æª¢æŸ¥é›»æ± ç‹€æ…‹
            const allBats = scene.querySelectorAll('.battery-group');
            const deadBats = scene.querySelectorAll('.battery-group.is-dead');
            
            // åªæœ‰ç•¶ã€Œå…¨éƒ¨é›»æ± ã€éƒ½æ²’é›»æ™‚ï¼Œæ‰ç®—æ–·é›»
            // (å‰ææ˜¯è©²å ´æ™¯æœ‰é›»æ± å…ƒä»¶ï¼Œåƒå ´æ™¯Bå’ŒD)
            const isPowerOff = (allBats.length > 0 && allBats.length === deadBats.length);

            bulbs.forEach(b => {
                // å…ˆç§»é™¤æ‰€æœ‰äº®åº¦ï¼Œé‡ç½®
                b.classList.remove('lit-dim', 'lit-normal', 'lit-bright');

                // åªæœ‰ç•¶ (é›»æºæœ‰é›») ä¸” (ç‡ˆæ³¡æ²’å£) æ™‚ï¼Œæ‰åŠ å›äº®åº¦
                if (!isPowerOff && !b.classList.contains('is-broken')) {
                    if (sceneId === 'scene-A') b.classList.add('lit-normal');
                    if (sceneId === 'scene-B') b.classList.add('lit-dim');
                    if (sceneId === 'scene-C') b.classList.add('lit-bright');
                    if (sceneId === 'scene-D') b.classList.add('lit-normal');
                }
            });
        }

        function updatePhysics(mode) {
            // åˆ‡æ›å ´æ™¯æ™‚ï¼Œé‡ç½®æ‰€æœ‰ç‹€æ…‹ç‚ºé è¨­ (å…¨äº®)
            document.querySelectorAll('.bulb-wrapper').forEach(b => {
                b.classList.remove('lit-dim', 'lit-normal', 'lit-bright', 'is-broken');
            });
            document.querySelectorAll('.battery-group').forEach(bat => {
                bat.classList.remove('is-dead');
            });

            const title = document.getElementById('infoTitle');
            const text = document.getElementById('infoText');

            if (mode === 'A') {
                document.getElementById('a-b1').classList.add('lit-normal');
                document.getElementById('a-b2').classList.add('lit-normal');
                title.innerText = "ç‡ˆæ³¡ä¸²è¯ ï¼‹ é›»æ± ä¸²è¯";
                text.innerText = "äº®åº¦ï¼šæ™®é€š\né›»æ± ä¸²è¯é›»åŠ›è®Šå¤§ï¼Œä½†æ˜¯å…©å€‹ç‡ˆæ³¡è¦å¹³åˆ†ï¼Œæ‰€ä»¥äº®åº¦å‰›å‰›å¥½\næƒ…æ³èˆ‡ï¼‘é¡†é›»æ± ï¼‹ï¼‘é¡†ç‡ˆæ³¡ç›¸åŒ";
            
            } else if (mode === 'B') {
                document.getElementById('b-b1').classList.add('lit-dim');
                document.getElementById('b-b2').classList.add('lit-dim');
                title.innerText = "ç‡ˆæ³¡ä¸²è¯ ï¼‹ é›»æ± ä¸¦è¯";
                text.innerText = "äº®åº¦ï¼šæœ€æš—\né›»æ± ä¸¦è¯ï¼Œç­‰åŒï¼‘é¡†é›»æ± çš„é›»åŠ›\nå¾®å¼±çš„é›»åŠ›é‚„è¦åˆ†çµ¦å…©å€‹ç‡ˆæ³¡ï¼Œæ‰€ä»¥æœ€æš—";
            
            } else if (mode === 'C') {
                document.getElementById('c-b1').classList.add('lit-bright');
                document.getElementById('c-b2').classList.add('lit-bright');
                title.innerText = "ç‡ˆæ³¡ä¸¦è¯ ï¼‹ é›»æ± ä¸²è¯";
                text.innerText = "äº®åº¦ï¼šæœ€äº®\né›»æ± ä¸²è¯é›»åŠ›è®Šå¤§\nä¸¦è¯çš„ç‡ˆæ³¡ä¸ç”¨å¹³åˆ†é›»åŠ›ï¼Œæ¯ä¸€é¡†éƒ½èƒ½åƒåˆ°é£½ï¼Œæ‰€ä»¥æœ€äº®";
            
            } else if (mode === 'D') {
                document.getElementById('d-b1').classList.add('lit-normal');
                document.getElementById('d-b2').classList.add('lit-normal');
                title.innerText = "ç‡ˆæ³¡ä¸¦è¯ ï¼‹ é›»æ± ä¸¦è¯";
                text.innerText = "äº®åº¦ï¼šæ™®é€š\né›»æ± ä¸¦è¯ï¼Œç­‰åŒï¼‘é¡†é›»æ± çš„é›»åŠ›\nä¸¦è¯ç‡ˆæ³¡é›–ç„¶ä¸ç”¨å¹³åˆ†ï¼Œä½†å› ç‚ºé›»åŠ›å¾®å¼±ï¼Œæ‰€ä»¥äº®åº¦ä¹Ÿå°±æ™®é€š\næƒ…æ³èˆ‡ï¼‘é¡†é›»æ± ï¼‹ï¼‘é¡†ç‡ˆæ³¡ç›¸åŒ";
            }
        }
    </script>
</body>
</html>
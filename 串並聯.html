<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ™Ÿè‡ªç„¶è¼”åŠ©ç³»çµ±ã€€ä¸²è¯èˆ‡ä¸¦è¯</title>
    <style>
        /* =========================================
           1. æ ¸å¿ƒæ¶æ§‹ (ç¹¼æ‰¿è‡ª LT.html æ¨™æº–)
           ========================================= */
        html, body {
            margin: 0; padding: 0;
            width: 100%; height: 100dvh;
            overflow: hidden;
            display: flex; flex-direction: column; align-items: center;
            background-image: url('page.jpg'); 
            background-size: cover; background-position: center;
            font-family: 'Microsoft JhengHei', 'Segoe UI', sans-serif;
            color: #333;
        }

        .app-layout-wrapper {
            width: 100%; max-width: 600px; height: 100%;
            display: flex; flex-direction: column; position: relative;
            background: transparent;
        }

        /* Header */
        .main-header {
            flex: 0 0 60px; width: 100%;
            background: linear-gradient(90deg, #1a2a6c, #b21f1f, #fdbb2d);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 100;
            display: flex; align-items: center; padding: 0 15px; box-sizing: border-box; color: white;
        }
        .logo-area {
            width: 40px; height: 40px; background-color: white; border-radius: 50%;
            margin-right: 15px; background-image: url('logo.jpg'); background-size: cover;
            border: 2px solid #00d2ff; flex-shrink: 0;
        }
        .header-title {
            font-size: 1.0rem; font-weight: bold; flex: 1; padding-right: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3); color: white;
            white-space: normal; line-height: 1.2;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
        }
        .line-btn {
            margin-left: auto; background-color: #00B900; color: white; text-decoration: none;
            padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.5);
            display: flex; align-items: center; justify-content: center; white-space: nowrap; flex-shrink: 0;
        }

        /* Content Area */
        .content-scroll-area {
            flex: 1 1 auto; overflow-y: auto; -webkit-overflow-scrolling: touch;
            width: 100%; padding: 0; padding-bottom: 20px;
            display: flex; flex-direction: column; align-items: center;
        }

        /* è¦–è¦ºæ¨¡æ“¬å€å®¹å™¨ (LTæ¨™æº–) */
        .simulation-container {
            width: 100%; display: flex; justify-content: center; align-items: flex-start;
            position: relative; margin-top: 10px; padding-top: 20px;
            min-height: 300px; overflow: visible;
        }
        
        /* é›»è·¯æ¿å›ºå®šå°ºå¯¸å®¹å™¨ (LTæ¨™æº–) */
        .circuit-board-scale {
            width: 500px; height: 450px; min-width: 500px; min-height: 450px;
            flex-shrink: 0; position: relative; transform-origin: center top;
            background: transparent;
        }

        /* UI Card & Dashboard (LTæ¨™æº–) */
        .ui-card {
            width: 96% !important; max-width: 96% !important; box-sizing: border-box;
            margin: 15px auto; background: rgba(255, 255, 255, 0.95);
            border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05); padding: 12px;
        }

        #status-dashboard {
            /* 1. å¤–è§€èˆ‡é–“è· */
            padding: 12px 15px; 
            margin-top: 10px; 
            border-left: 5px solid #3498db;
            
            /* 2. é—œéµï¼šé˜²æ­¢è·³å‹•çš„å›ºå®šé«˜åº¦ (å®¹ç´3~4è¡Œæ–‡å­—) */
            min-height: 150px;   
            
            /* 3. é—œéµï¼šå•Ÿç”¨ Flexbox è®“å…§å®¹å¯ä»¥ä¸Šä¸‹åˆ†é–‹ */
            display: flex; 
            flex-direction: column; 
            justify-content: flex-start; /* å…§å®¹é è¨­é ä¸Š */
        }

        .dashboard-header-row {
            display: flex; flex-wrap: wrap; justify-content: space-between;
            align-items: center; gap: 8px; margin-bottom: 8px;
            flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
        }

        .info-title { font-weight: bold; color: #2980b9; font-size: 1.1rem; }

        .answer-badge {
            display: inline-block; background-color: #d35400; color: white;
            font-size: 1rem; font-weight: bold; padding: 2px 8px;
            border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transform: translateY(-1px);
        }

        .dashboard-text-left {
            font-size: 0.95rem; color: #555; display: block; text-align: left;
            line-height: 1.6; padding: 0; margin-bottom: 8px;
            flex-grow: 1; /* ä½”æ“šå‰©é¤˜ç©ºé–“ï¼Œä½†ä¸å¼·åˆ¶æ’é–‹ */
        }
		
		.dashboard-footer {
            margin-top: auto; /* é€™è¡Œç¨‹å¼ç¢¼æœƒè‡ªå‹•æŠŠå®ƒã€Œæ¨ã€åˆ°æœ€ä¸‹é¢ */
            text-align: center;
            width: 100%;
        }

        .interaction-hint {
            font-size: 0.85rem; color: #7f8c8d; background-color: #f7f9f9;
            padding: 4px 10px; border-radius: 12px; display: inline-block;
            margin-top: 5px; border: 1px dashed #bdc3c7;
        }

        /* =========================================
           2. å…ƒä»¶æ¨£å¼ (åˆä½µ SP èˆ‡ LT)
           ========================================= */
        :root {
            --wire-color: #333;
            --bulb-off: #bdc3c7;
            --bulb-dim-color: #cca300;
            --bulb-norm-color: #f1c40f;
            --bulb-bright-color: #fff700;
        }

        .circuit-scene { position: absolute; width: 100%; height: 100%; display: none; }
        .circuit-scene.active { display: block; }

        /* Wires */
        .wire { position: absolute; background-image: linear-gradient(0deg, #2c3e50, #5d6d7e 40%, #85929e 60%, #2c3e50); border-radius: 4px; z-index: 1; }
        .wire-h { height: 6px; } .wire-v { width: 6px; }

        /* Bulbs */
        .bulb-wrapper { position: absolute; display: flex; flex-direction: column; align-items: center; z-index: 10; cursor: pointer; transition: transform 0.1s; }
        .bulb-wrapper:active { transform: scale(0.95); }
        
        .bulb-glass { 
            width: 40px; height: 40px; border-radius: 50%; background-color: var(--bulb-off); 
            border: 2px solid #95a5a6; position: relative; transition: all 0.3s ease; 
            box-shadow: inset -2px -2px 5px rgba(0,0,0,0.2);
        }
        
        .bulb-base { 
            width: 20px; height: 16px; background: linear-gradient(90deg, #7f8c8d, #bdc3c7, #95a5a6); 
            border: 1px solid #555; margin-top: -2px; border-radius: 0 0 6px 6px; z-index: 9;
        }
        
        .bulb-status { 
            font-size: 10px; color: #e74c3c; font-weight: bold; margin-top: 2px; 
            opacity: 0; position: absolute; top: -15px; background: white; 
            padding: 1px 3px; border-radius: 3px; 
        }

        .lit-dim .bulb-glass { background-color: var(--bulb-dim-color); border-color: #b7950b; box-shadow: 0 0 10px var(--bulb-dim-color); }
        .lit-normal .bulb-glass { background-color: var(--bulb-norm-color); border-color: #f39c12; box-shadow: 0 0 30px var(--bulb-norm-color); }
        .lit-bright .bulb-glass { background-color: var(--bulb-bright-color); border-color: #fff; box-shadow: 0 0 50px var(--bulb-bright-color); }
        .broken .bulb-glass { background-color: #333; } .broken .bulb-status { opacity: 1; }

        /* Batteries */
        .battery-group { position: absolute; display: flex; align-items: center; z-index: 5; cursor: pointer; transition: transform 0.1s; }
        .battery-group:active { transform: scale(0.95); }
        .battery-body { width: 60px; height: 36px; background: linear-gradient(to bottom, #34495e 0%, #5d6d7e 50%, #2c3e50 100%); border: 2px solid #ecf0f1; border-radius: 4px; display: flex; justify-content: space-between; align-items: center; padding: 0 5px; position: relative; }
        .battery-cap { width: 8px; height: 18px; background: linear-gradient(to bottom, #bdc3c7, #ecf0f1, #bdc3c7); border: 1px solid #95a5a6; border-right: none; position: absolute; left: -8px; top: 50%; transform: translateY(-50%); border-radius: 3px 0 0 3px; }
        .bat-sign { font-weight: 900; font-size: 18px; line-height: 1; }
        .sign-plus { color: #ff5252; } .sign-minus { color: #448aff; }
        
        .battery-dead .battery-body { background: #7f8c8d; } 
        .battery-status { position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #555; background: white; padding: 1px 4px; border-radius: 3px; opacity: 0; font-weight: bold; white-space: nowrap; }
        .battery-dead .battery-status { opacity: 1; }

        .polarity { position: absolute; font-size: 14px; font-weight: bold; color: #7f8c8d; pointer-events: none; z-index: 15; }
        .p-pos { color: #e74c3c; } .p-neg { color: #3498db; }

        /* Footer / Controls (LTæ¨™æº–) */
        .controls-dock {
            flex: 0 0 auto; width: 100%; background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 -4px 15px rgba(0,0,0,0.1); z-index: 1000; padding: 10px;
            box-sizing: border-box; padding-bottom: calc(10px + env(safe-area-inset-bottom));
            display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
        }

        .scene-btn { 
            padding: 10px 5px; border: none; border-radius: 8px; font-size: 0.9rem; 
            cursor: pointer; color: white; transition: all 0.2s; background: #95a5a6; 
            font-family: inherit; line-height: 1.2; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center; text-align: center;
        }
        .scene-btn:hover { filter: brightness(1.1); }
        .scene-btn:active { transform: scale(0.98); }
        .scene-btn.active { background: linear-gradient(135deg, #3498db, #2980b9); box-shadow: 0 2px 5px rgba(0,0,0,0.3); font-weight: bold; }

    </style>
</head>
<body>
    <div class="app-layout-wrapper">
    
        <header class="main-header">
            <a href="index.html" class="logo-area" title="è¿”å›å¤§å»³"></a>
            <div class="header-title">æ™Ÿè‡ªç„¶è¼”åŠ©ç³»çµ±<br>ä¸²è¯èˆ‡ä¸¦è¯</div>
            <a href="https://line.me/ti/g2/TTCqPpZP6lQqX1z_AUDPNm4977Dvylew3O7oBg" target="_blank" class="line-btn">åŠ  LINE è¨è«–</a>
        </header>

        <main class="content-scroll-area">
            
            <div class="ui-card" id="status-dashboard">
                <div class="dashboard-header-row">
                    <span class="info-title" id="infoTitle">æº–å‚™å°±ç·’</span>
                    <span class="answer-badge" id="infoBrightness">è«‹æ“ä½œ</span>
                </div>
                
                <div class="dashboard-text-left" id="infoText">
                    è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡é›»è·¯ï¼Œä¸¦é»æ“Šåœ–ä¸­å…ƒä»¶é€²è¡Œäº’å‹•ã€‚
                </div>
                
                <div class="dashboard-footer"> 
                    <div class="interaction-hint">
                        ğŸ’¡ é»æ“Šã€Œç‡ˆæ³¡ã€æˆ–ã€Œé›»æ± ã€å¯æ¨¡æ“¬æ•…éšœèˆ‡æ²’é›»
                    </div>
                </div>
            </div>
            
            <div class="simulation-container" id="sim-container">
    <div class="circuit-board-scale" id="circuit-board">
           
        <div class="circuit-scene" id="scene-bulb-series">
            <div class="wire wire-h" style="width: 240px; top: 60px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; right: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; top: 340px; left: 130px;"></div>
            
            <div class="battery-group" style="top: 322px; left: 220px; cursor: default;">
                <div class="battery-cap"></div>
                <div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            
            <div class="bulb-wrapper" id="b1-s" style="top: 40px; left: 170px;" onclick="toggleBulb('b1-s')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            <div class="bulb-wrapper" id="b2-s" style="top: 40px; left: 290px;" onclick="toggleBulb('b2-s')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            
            <div class="polarity p-pos" style="top: 65px; left: 165px;">+</div> <div class="polarity p-neg" style="top: 65px; left: 215px;">-</div>
            <div class="polarity p-pos" style="top: 65px; left: 285px;">+</div> <div class="polarity p-neg" style="top: 65px; left: 335px;">-</div>
        </div>

        <div class="circuit-scene" id="scene-bulb-parallel">
            <div class="wire wire-h" style="width: 240px; top: 40px; left: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; top: 130px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 300px; top: 40px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 300px; top: 40px; right: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; top: 340px; left: 130px;"></div>

            <div class="battery-group" style="top: 322px; left: 220px; cursor: default;">
                <div class="battery-cap"></div>
                <div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            
            <div class="bulb-wrapper" id="b1-p" style="top: 20px; left: 230px;" onclick="toggleBulb('b1-p')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            <div class="bulb-wrapper" id="b2-p" style="top: 110px; left: 230px;" onclick="toggleBulb('b2-p')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            
            <div class="polarity p-pos" style="top: 45px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 45px; left: 275px;">-</div>
            <div class="polarity p-pos" style="top: 135px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 135px; left: 275px;">-</div>
        </div>

        <div class="circuit-scene" id="scene-bat-series">
            <div class="wire wire-h" style="width: 240px; top: 60px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; right: 130px;"></div>
            
            <div class="wire wire-h" style="width: 90px; top: 340px; left: 130px;"></div>
            <div class="battery-group" id="bat1-s" style="top: 322px; left: 175px;" onclick="toggleBattery('bat1-s')">
                <div class="battery-status">æ²’é›»</div>
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            <div class="wire wire-h" style="width: 50px; top: 340px; left: 225px;"></div>
            <div class="battery-group" id="bat2-s" style="top: 322px; left: 265px;" onclick="toggleBattery('bat2-s')">
                <div class="battery-status">æ²’é›»</div>
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>
            <div class="wire wire-h" style="width: 90px; top: 340px; right: 130px;"></div>

            <div class="bulb-wrapper" id="b1-bs" style="top: 40px; left: 230px;">
                <div class="bulb-glass"></div><div class="bulb-base"></div>
            </div>
            <div class="polarity p-pos" style="top: 65px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 65px; left: 275px;">-</div>
        </div>

        <div class="circuit-scene" id="scene-bat-parallel">
            <div class="wire wire-h" style="width: 240px; top: 40px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 300px; top: 40px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 300px; top: 40px; right: 130px;"></div>
            
            <div class="wire wire-h" style="width: 240px; top: 250px; left: 130px;"></div>
            <div class="battery-group" id="bat1-p" style="top: 232px; left: 220px;" onclick="toggleBattery('bat1-p')">
                <div class="battery-status">æ²’é›»</div>
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>

            <div class="wire wire-h" style="width: 240px; top: 340px; left: 130px;"></div>
            <div class="battery-group" id="bat2-p" style="top: 322px; left: 220px;" onclick="toggleBattery('bat2-p')">
                <div class="battery-status">æ²’é›»</div>
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>

            <div class="bulb-wrapper" id="b1-bp" style="top: 20px; left: 230px;">
                <div class="bulb-glass"></div><div class="bulb-base"></div>
            </div>
            <div class="polarity p-pos" style="top: 45px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 45px; left: 275px;">-</div>
        </div>

        <div class="circuit-scene" id="scene-mixed-1">
            <div class="wire wire-h" style="width: 240px; top: 60px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; left: 130px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; left: 250px;"></div>
            <div class="wire wire-v" style="height: 280px; top: 60px; right: 130px;"></div>
            <div class="wire wire-h" style="width: 240px; top: 340px; left: 130px;"></div>

            <div class="battery-group" id="bat-m1" style="top: 182px; left: 95px; transform: rotate(90deg);" onclick="toggleBattery('bat-m1')">
                <div class="battery-status" style="transform: rotate(-90deg); top: -30px; left: 10px;">æ²’é›»</div>
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>

            <div class="bulb-wrapper" id="b1-m1" style="top: 120px; left: 233px;" onclick="toggleBulb('b1-m1')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            <div class="bulb-wrapper" id="b2-m1" style="top: 240px; left: 233px;" onclick="toggleBulb('b2-m1')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            
            <div class="bulb-wrapper" id="b3-m1" style="top: 180px; left: 347px;" onclick="toggleBulb('b3-m1')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            
            <div class="polarity p-pos" style="top: 125px; left: 215px; color: #333;">A</div>
            <div class="polarity p-pos" style="top: 245px; left: 215px; color: #333;">B</div>
            <div class="polarity p-pos" style="top: 185px; left: 325px; color: #333;">C</div>

            <div class="polarity p-pos" style="top: 100px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 165px; left: 225px;">-</div>
            <div class="polarity p-pos" style="top: 220px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 285px; left: 225px;">-</div>
            <div class="polarity p-pos" style="top: 160px; left: 340px;">+</div> <div class="polarity p-neg" style="top: 225px; left: 340px;">-</div>
        </div>

        <div class="circuit-scene" id="scene-mixed-2">
            <div class="wire wire-v" style="height: 280px; top: 60px; left: 130px;"></div> 
            <div class="wire wire-h" style="width: 122px; top: 60px; left: 130px;"></div> 
            <div class="wire wire-h" style="width: 120px; top: 60px; left: 250px;"></div> 
            <div class="wire wire-v" style="height: 280px; top: 60px; left: 250px;"></div> 
            <div class="wire wire-v" style="height: 280px; top: 60px; right: 130px;"></div> 
            
            <div class="wire wire-h" style="width: 120px; top: 340px; left: 250px;"></div> 
            <div class="wire wire-h" style="width: 122px; top: 340px; left: 130px;"></div> 
            
            <div class="battery-group" id="bat-m2" style="top: 182px; left: 95px; transform: rotate(90deg);" onclick="toggleBattery('bat-m2')">
                <div class="battery-status" style="transform: rotate(-90deg); top: -30px; left: 10px;">æ²’é›»</div>
                <div class="battery-cap"></div><div class="battery-body"><span class="bat-sign sign-plus">+</span><span class="bat-sign sign-minus">-</span></div>
            </div>

            <div class="bulb-wrapper" id="b1-m2" style="top: 180px; left: 233px;" onclick="toggleBulb('b1-m2')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            <div class="bulb-wrapper" id="b2-m2" style="top: 180px; left: 347px;" onclick="toggleBulb('b2-m2')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            
            <div class="bulb-wrapper" id="b3-m2" style="top: 320px; left: 173px;" onclick="toggleBulb('b3-m2')">
                <div class="bulb-glass"></div><div class="bulb-base"></div><div class="bulb-status">å£æ‰</div>
            </div>
            
            <div class="polarity p-pos" style="top: 185px; left: 215px; color: #333;">B</div>
            <div class="polarity p-pos" style="top: 185px; left: 325px; color: #333;">C</div>
            <div class="polarity p-pos" style="top: 295px; left: 188px; color: #333;">A</div>

            <div class="polarity p-pos" style="top: 160px; left: 225px;">+</div> <div class="polarity p-neg" style="top: 225px; left: 225px;">-</div>
            <div class="polarity p-pos" style="top: 160px; left: 340px;">+</div> <div class="polarity p-neg" style="top: 225px; left: 340px;">-</div>
            <div class="polarity p-pos" style="top: 325px; left: 215px;">+</div> <div class="polarity p-neg" style="top: 325px; left: 160px;">-</div>
        </div>

    </div>
</div>

        </main>

        <footer class="controls-dock" id="controls-area">
            <button class="scene-btn active" onclick="switchScene('bulb-series', this)">ç‡ˆæ³¡ä¸²è¯</button>
            <button class="scene-btn" onclick="switchScene('bulb-parallel', this)">ç‡ˆæ³¡ä¸¦è¯</button>
            <button class="scene-btn" onclick="switchScene('bat-series', this)">é›»æ± ä¸²è¯</button>
            <button class="scene-btn" onclick="switchScene('bat-parallel', this)">é›»æ± ä¸¦è¯</button>
            <button class="scene-btn" onclick="switchScene('mixed-1', this)">é€²éšï¼šäºŒä¸²ä¸¦ä¸€</button>
            <button class="scene-btn" onclick="switchScene('mixed-2', this)">é€²éšï¼šäºŒä¸¦ä¸²ä¸€</button>
        </footer>
    </div>

    <script>
        // ----------------------------------------------------
        // é‚è¼¯æ ¸å¿ƒ (çµæ§‹é‡æ§‹)
        // ----------------------------------------------------
        let currentMode = 'bulb-series';
        let brokenState = { 'b1-s': false, 'b2-s': false, 'b1-p': false, 'b2-p': false };
        let batteryDead = { 'bat1-s': false, 'bat2-s': false, 'bat1-p': false, 'bat2-p': false };
        let brokenStateMixed = { 
            'b1-m1': false, 'b2-m1': false, 'b3-m1': false, 
            'b1-m2': false, 'b2-m2': false, 'b3-m2': false 
        };
        let batteryDeadMixed = { 'bat-m1': false, 'bat-m2': false };

        // 1. åˆå§‹åŒ–èˆ‡ç¸®æ”¾
        window.addEventListener('DOMContentLoaded', () => {
            switchScene('bulb-series', document.querySelector('.scene-btn'));
            autoFitCircuit();
        });
        window.addEventListener('resize', autoFitCircuit);

        function autoFitCircuit() {
            const board = document.getElementById('circuit-board');
            const container = document.getElementById('sim-container');
            const logicalWidth = 500; 
            const logicalHeight = 450; // å¾®èª¿é«˜åº¦ä»¥å®¹ç´æ··åˆé›»è·¯
            
            const availableWidth = container.clientWidth - 20; 
            let scale = Math.min(availableWidth / logicalWidth, 1);
            
            board.style.transform = `scale(${scale})`;
            container.style.height = `${logicalHeight * scale}px`;
            container.style.minHeight = `${logicalHeight * scale}px`;
        }

        // 2. å ´æ™¯åˆ‡æ›
        function switchScene(mode, btn) {
            currentMode = mode;
            document.querySelectorAll('.scene-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            
            document.querySelectorAll('.circuit-scene').forEach(s => s.classList.remove('active'));
            document.getElementById('scene-' + mode).classList.add('active');
            
            updateCircuit();
        }

        // 3. äº’å‹•è§¸ç™¼
        function toggleBulb(id) {
            if (id in brokenStateMixed) {
                brokenStateMixed[id] = !brokenStateMixed[id];
                const bulb = document.getElementById(id);
                if (brokenStateMixed[id]) bulb.classList.add('broken');
                else bulb.classList.remove('broken');
            } else {
                brokenState[id] = !brokenState[id];
                const bulb = document.getElementById(id);
                if (brokenState[id]) bulb.classList.add('broken');
                else bulb.classList.remove('broken');
            }
            updateCircuit();
        }

        function toggleBattery(id) {
            if (id in batteryDeadMixed) {
                batteryDeadMixed[id] = !batteryDeadMixed[id];
                const bat = document.getElementById(id);
                if (batteryDeadMixed[id]) bat.classList.add('battery-dead');
                else bat.classList.remove('battery-dead');
            } else {
                batteryDead[id] = !batteryDead[id];
                const bat = document.getElementById(id);
                if (batteryDead[id]) bat.classList.add('battery-dead');
                else bat.classList.remove('battery-dead');
            }
            updateCircuit();
        }

        // 4. ç‰©ç†é‚è¼¯èˆ‡å„€è¡¨æ¿æ›´æ–°
        function updateCircuit() {
            // é‡ç½®æ‰€æœ‰ç‡ˆæ³¡äº®åº¦
            document.querySelectorAll('.bulb-wrapper').forEach(b => {
                b.classList.remove('lit-normal', 'lit-dim', 'lit-bright');
            });

            let displayData = { title: "", bright: "", desc: "", color: "" };

            if (currentMode === 'bulb-series') {
                displayData.title = "ç‡ˆæ³¡ä¸²è¯";
                const b1 = brokenState['b1-s'];
                const b2 = brokenState['b2-s'];
                if (!b1 && !b2) {
                    document.getElementById('b1-s').classList.add('lit-dim');
                    document.getElementById('b2-s').classList.add('lit-dim');
                    displayData.bright = "äº®åº¦ï¼šè¼ƒæš—";
                    displayData.desc = "ç‡ˆæ³¡äº®åº¦è¼ƒæš—ï¼Œå› ç‚ºèƒ½é‡è¢«å…©å€‹ç‡ˆæ³¡å¹³åˆ†äº†ã€‚";
                    displayData.color = "#cca300";
                } else {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "å› ç‚ºåªæœ‰ä¸€æ¢è·¯ï¼Œä¸€å€‹ç‡ˆæ³¡ç†„æ»…ï¼Œå…¨éƒ¨è·Ÿè‘—ç†„æ»…ã€‚";
                    displayData.color = "#7f8c8d";
                }

            } else if (currentMode === 'bulb-parallel') {
                displayData.title = "ç‡ˆæ³¡ä¸¦è¯";
                const b1 = brokenState['b1-p'];
                const b2 = brokenState['b2-p'];
                
                if (!b1) document.getElementById('b1-p').classList.add('lit-normal');
                if (!b2) document.getElementById('b2-p').classList.add('lit-normal');

                if (b1 && b2) {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "å…©é¡†ç‡ˆæ³¡éƒ½ç†„æ»…äº†ï¼Œæ²’æœ‰ä»»ä½•é€šè·¯ï¼Œå…¨éƒ½ä¸äº®ã€‚";
                    displayData.color = "#7f8c8d";
                } else {
                    displayData.bright = "äº®åº¦ï¼šæ™®é€š";
                    displayData.color = "#f39c12";
                    let text = "å„ç‡ˆæ³¡éƒ½æ˜¯ç¨ç«‹é›»è·¯ï¼Œäº’ä¸å½±éŸ¿ã€‚";
                    if (b1 && !b2) text = "ä¸Šæ–¹ç†„æ»…ï¼Œä¸‹æ–¹ä¾ç„¶æœƒäº®ï¼Œäº®åº¦ä¸è®Šï¼äº’ä¸å½±éŸ¿ã€‚";
                    if (!b1 && b2) text = "ä¸‹æ–¹ç†„æ»…ï¼Œä¸Šæ–¹ä¾ç„¶æœƒäº®ï¼Œäº®åº¦ä¸è®Šï¼äº’ä¸å½±éŸ¿ã€‚";
                    displayData.desc = text;
                }

            } else if (currentMode === 'bat-series') {
                displayData.title = "é›»æ± ä¸²è¯";
                if (batteryDead['bat1-s'] || batteryDead['bat2-s']) {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "ç•¶ä¸€é¡†é›»æ± æ²’é›»ï¼Œé›»æµæœƒè®Šå¾—éå¸¸å¾®å¼±ï¼Œç‡ˆæ³¡ç†„æ»…ã€‚";
                    displayData.color = "#7f8c8d";
                } else {
                    document.getElementById('b1-bs').classList.add('lit-bright');
                    displayData.bright = "äº®åº¦ï¼šè¶…äº®";
                    displayData.desc = "å…©é¡†é›»æ± ä¸²è¯ï¼Œé›»å£“ç›¸åŠ ï¼Œç‡ˆæ³¡è¶…ç´šäº®ï¼";
                    displayData.color = "#e74c3c"; // Red for intense
                }

            } else if (currentMode === 'bat-parallel') {
                displayData.title = "é›»æ± ä¸¦è¯";
                let activeBats = 0;
                if (!batteryDead['bat1-p']) activeBats++;
                if (!batteryDead['bat2-p']) activeBats++;

                if (activeBats > 0) {
                    document.getElementById('b1-bp').classList.add('lit-normal');
                    displayData.bright = "äº®åº¦ï¼šæ™®é€š";
                    displayData.color = "#f39c12";
                    if(activeBats === 2) {
                         displayData.desc = "é›»æ± ä¸¦è¯ï¼Œé›»å£“ä¸è®Šï¼Œäº®åº¦å’Œä¸€é¡†é›»æ± ç›¸åŒã€‚";
                    } else {
                         displayData.desc = "ä¸€é¡†æ²’é›»ï¼Œå¦ä¸€é¡†é‚„åœ¨ä¾›é›»ï¼Œäº®åº¦ç¶­æŒä¸è®Šï¼";
                    }
                } else {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "å…©é¡†é›»æ± éƒ½æ²’é›»äº†ï¼Œç‡ˆæ³¡ç†„æ»…ã€‚";
                    displayData.color = "#7f8c8d";
                }
            }
            
            else if (currentMode === 'mixed-1') {
                displayData.title = "äºŒä¸²ä¸¦ä¸€";
                const bat = batteryDeadMixed['bat-m1'];
                const bSeries1 = brokenStateMixed['b1-m1'];
                const bSeries2 = brokenStateMixed['b2-m1'];
                const bSolo = brokenStateMixed['b3-m1'];

                if (bat) {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "é›»æ± æ²’é›»äº†ã€‚";
                    displayData.color = "#7f8c8d";
                } else {
                    let msgParts = [];
                    if (!bSeries1 && !bSeries2) {
                        document.getElementById('b1-m1').classList.add('lit-dim');
                        document.getElementById('b2-m1').classList.add('lit-dim');
                        msgParts.push("ï¼¡ï¼¢ä¸²è¯(è¼ƒæš—)");
                    } else {
                        msgParts.push("ï¼¡ï¼¢æ–·è·¯");
                    }
                    if (!bSolo) {
                        document.getElementById('b3-m1').classList.add('lit-bright');
                        msgParts.push("ï¼£ç¨ç«‹(è¶…äº®)");
                    } else {
                        msgParts.push("ï¼£æ–·è·¯");
                    }

                    if ((bSeries1 || bSeries2) && bSolo) {
                        displayData.bright = "æ–·è·¯";
                        displayData.desc = "å…©æ¢æ”¯è·¯éƒ½ä¸é€šï¼Œå…¨æ»…ã€‚";
                        displayData.color = "#7f8c8d";
                    } else {
                        displayData.bright = "æ··åˆäº®åº¦";
                        displayData.color = "#9b59b6"; // Purple for mixed
                        displayData.desc = "å…©æ¢ä¸¦è¯äº’ä¸å½±éŸ¿ã€‚" + msgParts.join("ï¼Œ") + "ã€‚";
                    }
                }
            }

            else if (currentMode === 'mixed-2') {
                displayData.title = "äºŒä¸¦ä¸²ä¸€";
                const bat = batteryDeadMixed['bat-m2'];
                const bMain = brokenStateMixed['b3-m2'];
                const bSub1 = brokenStateMixed['b1-m2'];
                const bSub2 = brokenStateMixed['b2-m2'];

                if (bat) {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "é›»æ± æ²’é›»äº†ã€‚";
                    displayData.color = "#7f8c8d";
                } else if (bMain) {
                    displayData.bright = "æ–·è·¯";
                    displayData.desc = "ï¼¡ç‡ˆæ³¡æœ‰å•é¡Œï¼Œé€ æˆæ•´å€‹é›»è·¯æ–·é›»ã€‚";
                    displayData.color = "#7f8c8d";
                } else {
                    let sub1_ok = !bSub1;
                    let sub2_ok = !bSub2;

                    if (sub1_ok && sub2_ok) {
                        document.getElementById('b3-m2').classList.add('lit-bright');
                        document.getElementById('b1-m2').classList.add('lit-dim');
                        document.getElementById('b2-m2').classList.add('lit-dim');
                        displayData.bright = "Aæœ€äº®ï¼ŒBCæš—";
                        displayData.color = "#e74c3c";
                        displayData.desc = "å…¨äº®æ™‚ï¼Œï¼¡æ‰¿å—ç¸½é›»æµï¼Œï¼¢ï¼£ä¸¦è¯é›»æµå¹³åˆ†ã€‚";
                    } else if (!sub1_ok && !sub2_ok) {
                        displayData.bright = "æ–·è·¯";
                        displayData.desc = "ï¼¢ï¼£å…¨éƒ¨å£äº†ï¼Œè¿´è·¯ä¸é€šã€‚";
                        displayData.color = "#7f8c8d";
                    } else {
                        document.getElementById('b3-m2').classList.add('lit-normal');
                        
                        if (sub1_ok) document.getElementById('b1-m2').classList.add('lit-normal');
                        if (sub2_ok) document.getElementById('b2-m2').classList.add('lit-normal');
                        
                        displayData.bright = "äº®åº¦ï¼šæ™®é€š";
                        displayData.color = "#f39c12";
                        displayData.desc = "å°‘äº†ï¼¢æˆ–ï¼£ï¼Œè®Šæˆï¼’ç‡ˆæ³¡ä¸²è¯ã€‚ç¸½é›»é˜»è®Šå¤§ï¼Œï¼¡è®Šæš—ï¼å¦ä¸€é¡†æ²’å£çš„å‰‡è®Šäº®ã€‚";
                    }
                }
            }

            updateDashboard(displayData);
        }

        function updateDashboard(data) {
            document.getElementById('infoTitle').innerText = data.title;
            const badge = document.getElementById('infoBrightness');
            badge.innerText = data.bright;
            badge.style.backgroundColor = data.color;
            document.getElementById('infoText').innerText = data.desc;
        }
		
    </script>
</body>
</html>